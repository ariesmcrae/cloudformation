{
  "AWSTemplateFormatVersion" : "2010-09-09",

  "Description" : "NetworkCrossStack",

  "Parameters" : {
    "VpcURL" : {
      "Type" : "String",      
      "Default" : "https://s3.amazonaws.com/ariesmcrae-cloudformation/VPC.json.template"
    },

    "InternetGatewayURL" : {
      "Type" : "String",      
      "Default" : "https://s3.amazonaws.com/ariesmcrae-cloudformation/InternetGateway.json.template"
    },

    "SubnetURL" : {
      "Type" : "String",      
      "Default" : "https://s3.amazonaws.com/ariesmcrae-cloudformation/Subnet.json.template"
    },

    "NatGatewayURL" : {
      "Type" : "String",      
      "Default" : "https://s3.amazonaws.com/ariesmcrae-cloudformation/NatGateway.json.template"
    }

  },




  "Resources" : {
    "VPC" : {
      "Type" : "AWS::CloudFormation::Stack",
      "Properties" : {
        "Parameters" : {
          "ParentStackName": {"Ref": "AWS::StackName"}          
        },
				"TemplateURL" : {"Ref": "VpcURL"},
				"TimeoutInMinutes" : "2"
      }
    },

    "InternetGateway" : {
      "Type" : "AWS::CloudFormation::Stack",
      "DependsOn": "VPC",      
      "Properties" : {
        "Parameters" : {
          "ParentStackName": {"Ref": "AWS::StackName"},
          "VPCId": {"Fn::GetAtt" : [ "VPC" , "Outputs.VpcId" ]}
        },
				"TemplateURL" : {"Ref": "InternetGatewayURL"},
				"TimeoutInMinutes" : "2"
      }
    },

    "Subnet" : {
      "Type" : "AWS::CloudFormation::Stack",
      "DependsOn": "VPC",      
      "Properties" : {
        "Parameters" : {
          "ParentStackName": {"Ref": "AWS::StackName"},
          "VPCId": {"Fn::GetAtt" : [ "VPC" , "Outputs.VpcId" ]}
        },
				"TemplateURL" : {"Ref": "SubnetURL"},
				"TimeoutInMinutes" : "2"
      }
    },

    "NATGatewayURL" : {
      "Type" : "AWS::CloudFormation::Stack",
      "DependsOn": [ "InternetGateway", "Subnet" ],      
      "Properties" : {
        "Parameters" : {
          "SubnetAZaPublicId": {"Fn::GetAtt" : [ "Subnet" , "Outputs.SubnetAZaPublicId" ]},
          "SubnetAZbPublicId": {"Fn::GetAtt" : [ "Subnet" , "Outputs.SubnetAZbPublicId" ]}
        },
				"TemplateURL" : {"Ref": "NatGatewayURL"},
				"TimeoutInMinutes" : "2"
      }
    }
    

  }
}





